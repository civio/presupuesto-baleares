# -*- coding: UTF-8 -*-

from coffin.shortcuts import render_to_response
from budget_app.models import Budget, BudgetBreakdown, EconomicCategory
from budget_app.views.helpers import *
import json

# Object used to define data as literal. See http://stackoverflow.com/a/2466207
class DataPoint(object):
    def __init__(self, *initial_data, **kwargs):
        for dictionary in initial_data:
            for key in dictionary:
                setattr(self, key, dictionary[key])
        for key in kwargs:
            setattr(self, key, kwargs[key])

data = [
    [2014, '001', True, 1720000,3580000,0,27200000,0,50000,50000,0,0],
    [2014, '002', True, 2490700,287430,57719,10153,0,6248472,8509190,0,819416],
    [2014, '003', True, 3124917,14720814,12484287,0,0,22280510,0,0,27834704],
    [2014, '004', True, 12953321,2489206,137981,0,0,1071527,0,0,905430],
    [2014, '005', True, 2334352,3631000,3789847,0,0,1144668,0,1300000,10399729],
    [2014, '006', True, 10500000,15396044.57,17954128.43,0,0,2215000,0,0,28510971],
    [2014, '007', True, 1923473,1453757,242000,0,0,0,0,0,1309091],
    [2014, '008', True, 1147534,341256,3785710,0,0,0,0,0,10124182],
    [2014, '010', True, 5874337,2033202,653696,1195120,0,348332,44154992,0,1173637],
    [2014, '011', True, 4200000,2900000,5060538,0,0,2200000,0,0,6428029],
    [2014, '017', True, 1674225,431230,5465,0,0,0,0,0,200417],
    [2014, '001', False, 0,0,500000,32000000,0,0,100000,0,0],
    [2014, '002', False, 0,0,446000,2400002,0,0,15577078,0,0],
    [2014, '003', False, 0,0,42649934,5202920,0,0,32592378,0,0],
    [2014, '004', False, 0,0,700000,14880508,0,0,1976957,0,0],
    [2014, '005', False, 0,0,1100000,2046517,3575000,4178350,0,0,11699729],
    [2014, '006', False, 0,0,6450173,36950000,450000,0,2215000,0,28510971],
    [2014, '007', False, 0,0,687000,2932230,0,0,1309091,0,0],
    [2014, '008', False, 0,0,0,5274500,0,0,10124182,0,0],
    [2014, '010', False, 0,0,0,9756355,0,0,45676961,0,0],
    [2014, '011', False, 0,0,15878029,3410538,0,0,1500000,0,0],
    [2014, '017', False, 0,0,735308,1375612,0,0,200417,0,0],
    [2014, '104', True, 3030904,2043629,578172,0,0,30000,0,0,7551579],
    [2014, '105', True, 582000,169400,0,0,0,48400,0,0,0],
    [2014, '108', True, 525000,2675000,0,0,0,0,0,0,0],
    [2014, '109', True, 2580000,22320000,100000,0,0,50000,0,0,500000],
    [2014, '110', True, 3120000,720000,85000,0,0,0,0,0,375000],
    [2014, '111', True, 518540,2230641,0,0,0,817750,0,0,0],
    [2014, '104', False, 0,0,789000,4863705,0,0,7581579,0,0],
    [2014, '105', False, 0,0,95000,656400,0,0,48400,0,0],
    [2014, '108', False, 0,0,0,3200000,0,0,0,0,0],
    [2014, '109', False, 0,0,1500000,24000000,0,0,50000,0,0],
    [2014, '110', False, 0,0,0,3925000,0,0,375000,0,0],
    [2014, '111', False, 0,0,1217019,1840000,69912,0,440000,0,0],
    [2014, '201', True, 2089516,1178584,576483,357168,0,76500,2780911,0,562500],
    [2014, '202', True, 2105133,320360,15000,0,0,95107,0,0,0],
    [2014, '203', True, 5607650,1833000,62600,42000,0,500001,0,0,84402],
    [2014, '209', True, 57000,25027,39198,0,0,0,0,0,135334],
    [2014, '210', True, 0,4000,0,0,0,2030000,0,0,0],
    [2014, '212', True, 3877406,5010921,78500,45000,0,106611,0,0,16742],
    [2014, '213', True, 388713,262287,0,0,0,0,0,0,0],
    [2014, '214', True, 945694,3046373,0,0,0,77262,0,0,0],
    [2014, '215', True, 10010000,1487305,0,3231720,0,0,0,0,0],
    [2014, '216', True, 0,0,0,65000,0,15000,15000,0,0],
    [2014, '222', True, 8000000,2568400,250000,18000,0,50000,0,0,1703485],
    [2014, '201', False, 0,0,377100,3769651,55000,0,3419911,0,0],
    [2014, '202', False, 0,0,216100,2304500,15000,0,0,0,0],
    [2014, '203', False, 0,0,0,7545250,0,0,584403,0,0],
    [2014, '209', False, 0,0,42000,79225,0,0,135334,0,0],
    [2014, '210', False, 0,0,0,4000,0,0,2030000,0,0],
    [2014, '212', False, 0,0,9063531,38438,100,0,33111,0,0],
    [2014, '213', False, 0,0,74385,569756,6859,0,0,0,0],
    [2014, '214', False, 0,0,1871714,2051991,68362,0,77262,0,0],
    [2014, '215', False, 0,0,1254025,13475000,0,0,0,0,0],
    [2014, '216', False, 0,0,0,55000,10000,0,30000,0,0],
    [2014, '222', False, 0,0,9266392,1120008,500000,0,1703485,0,0],
    [2014, '301', True, 979519,263118,1455,0,0,0,0,0,0],
    [2014, '302', True, 2600000,1100000,0,0,0,100000,0,0,0],
    [2014, '303', True, 0,50128,0,0,0,707624,0,0,0],
    [2014, '304', True, 415000,1310000,570930,0,0,650000,0,0,3062704],
    [2014, '305', True, 0,50000,1464099,0,0,0,0,0,13196329],
    [2014, '306', True, 4150000,643178,60000,0,0,9000,0,0,0],
    [2014, '307', True, 0,0,400550,0,0,0,0,0,451139],
    [2014, '021', True, 1075300,1120093,0,606100,0,18000,200000,0,0],
    [2014, '309', True, 0,356500,0,0,0,64522,0,0,0],
    [2014, '310', True, 0,0,102076,0,0,0,0,0,463771],
    [2014, '311', True, 650569,31273591,0,0,0,1261573,0,0,0],
    [2014, '312', True, 60000,10000,474500,0,0,0,0,0,864250],
    [2014, '313', True, 33000,6000,95090,0,0,0,0,0,233601],
    [2014, '314', True, 362000,186515,1659106,0,0,0,350000,0,1006002],
    [2014, '315', True, 79900,74090,0,0,0,2000,0,0,0],
    [2014, '301', False, 0,0,33000,1211092,0,0,0,0,0],
    [2014, '302', False, 0,0,1290000,1880000,530000,0,100000,0,0],
    [2014, '303', False, 0,0,747752,0,10000,0,0,0,0],
    [2014, '304', False, 0,0,0,2070930,225000,0,3712704,0,0],
    [2014, '305', False, 0,0,0,1514099,0,0,13196329,0,0],
    [2014, '306', False, 0,0,200000,4662178,0,0,0,0,0],
    [2014, '307', False, 0,0,0,400550,0,0,451139,0,0],
    [2014, '021', False, 0,0,238000,2569493,0,0,212000,0,0],
    [2014, '309', False, 0,0,3500,353000,0,0,64522,0,0],
    [2014, '310', False, 0,0,0,102076,0,0,463771,0,0],
    [2014, '311', False, 0,0,26072601,6801732,0,0,311400,0,0],
    [2014, '312', False, 0,0,0,544500,0,0,864250,0,0],
    [2014, '313', False, 0,0,0,124090,10000,0,233601,0,0],
    [2014, '314', False, 0,0,0,2207621,0,0,1356002,0,0],
    [2014, '315', False, 0,0,2000,153990,0,0,0,0,0],
    [2015, '001', True, 4825000,28110000,100000,0,0,600000,0,0,465000],
    [2015, '002', True, 2610872,395863,146568,5306181,0,3693028,8509190,0,819416],
    [2015, '003', True, 3102700,14922548,11738260,0,0,31061037,0,0,31263275],
    [2015, '004', True, 13253321,2419977,107210,0,0,871527,0,0,905430],
    [2015, '005', True, 2334694,3721500,2947513,0,0,1271502,0,1300000,10901947],
    [2015, '006', True, 10600000,14636892,16925000,0,0,5547484,0,0,30783700],
    [2015, '007', True, 1672740,1596490,100000,0,0,0,0,0,1309091],
    [2015, '008', True, 1564804,335568,2560183,0,0,6762873,0,0,10674500],
    [2015, '010', True, 5874337,2033202,304688,1301000,0,330000,54253961,0,1173637],
    [2015, '011', True, 4200000,2900000,4631192,0,0,1071971,0,0,6428029],
    [2015, '017', True, 1640480,526256,29707,0,0,0,0,0,200417],
    [2015, '018', True, 3030904,1483652,550163,0,0,60000,0,0,6866674],
    [2015, '019', True, 602000,169400,0,0,0,28400,0,0,0],
    [2015, '001', False, 0,0,1500000,32000000,0,0,600000,0,0],
    [2015, '002', False, 0,0,400000,8059484,0,0,13021634,0,0],
    [2015, '003', False, 0,0,46643347,4087012,0,0,41357461,0,0],
    [2015, '004', False, 0,0,700000,15080508,0,0,1776957,0,0],
    [2015, '005', False, 0,0,1100000,2802936,3535000,2535668,301605,0,12201947],
    [2015, '006', False, 0,0,6500000,35211892,450000,0,5547484,0,30783700],
    [2015, '007', False, 0,0,687000,2682230,0,0,1309091,0,0],
    [2015, '008', False, 0,0,0,4460555,0,0,17437373,0,0],
    [2015, '010', False, 0,0,0,9513227,0,0,55757598,0,0],
    [2015, '011', False, 0,0,16000000,3231192,0,0,0,0,0],
    [2015, '017', False, 0,0,747856,1448587,0,0,200417,0,0],
    [2015, '018', False, 0,0,416206,4648513,0,0,6926674,0,0],
    [2015, '019', False, 0,0,55000,716400,0,0,28400,0,0],
    [2015, '110', True, 3120000,720000,85000,0,0,0,0,0,375000],
    [2015, '111', True, 592001,2785561,0,0,0,652000,0,0,0],
    [2015, '110', False, 0,0,0,3925000,0,0,375000,0,0],
    [2015, '111', False, 0,0,1431562,1946000,0,0,652000,0,0],
    [2015, '201', True, 2005000,713438,337533,232930,0,45534,2811877,0,562500],
    [2015, '202', True, 2170000,318500,0,0,0,20000,0,0,0],
    [2015, '203', True, 5886330,1987000,53034,42000,0,0,0,0,84402],
    [2015, '209', True, 64000,25427,33189,0,0,0,0,0,135334],
    [2015, '210', True, 0,52000,0,0,0,2698624,0,0,0],
    [2015, '212', True, 3877406,5120876,10000,45000,0,433856,0,0,17200],
    [2015, '213', True, 405476,248480,0,0,0,0,0,0,0],
    [2015, '214', True, 1085502,3963379,0,0,0,145803,0,0,0],
    [2015, '215', True, 10110000,1527640,0,10658585,0,0,0,0,0],
    [2015, '216', True, 0,0,0,65000,0,15000,15000,0,0],
    [2015, '222', True, 7940000,2751637,245041,10617,0,50000,0,0,1703485],
    [2015, '201', False, 0,0,199250,3089651,0,0,3419911,0,0],
    [2015, '202', False, 0,0,192000,2304500,12000,0,0,0,0],
    [2015, '203', False, 0,0,0,7968364,0,0,84402,0,0],
    [2015, '209', False, 0,0,49427,73189,0,0,135334,0,0],
    [2015, '210', False, 0,0,0,52000,0,0,2698624,0,0],
    [2015, '212', False, 0,0,9122861,50876,100,0,330501,0,0],
    [2015, '213', False, 0,0,78200,569756,6000,0,0,0,0],
    [2015, '214', False, 0,0,1897821,3099363,51697,0,145803,0,0],
    [2015, '215', False, 0,0,1350060,20623820,322345,0,0,0,0],
    [2015, '216', False, 0,0,0,55000,10000,0,30000,0,0],
    [2015, '222', False, 0,0,9918361,558934,520000,0,1703485,0,0],
    [2015, '301', True, 921282,285036,0,0,0,10000,0,0,0],
    [2015, '302', True, 2560000,1240000,0,0,0,100000,0,0,0],
    [2015, '303', True, 0,10000,0,500000,0,537639,0,0,0],
    [2015, '304', True, 420000,1281800,528127,0,0,600000,0,0,3080269],
    [2015, '305', True, 0,25000,1084562,0,0,0,0,0,12951229],
    [2015, '306', True, 4150000,1226450,2000,0,0,6000,0,0,0],
    [2015, '307', True, 0,0,362405,0,0,0,0,0,705842],
    [2015, '021', True, 1093912,1020025,0,627856,0,90000,200000,0,0],
    [2015, '309', True, 0,513458,0,0,0,28000,0,0,0],
    [2015, '310', True, 0,0,49083,0,0,0,0,0,460449],
    [2015, '311', True, 651076,31911839,0,0,0,1065155,0,0,0],
    [2015, '312', True, 0,0,430000,0,0,0,0,0,885000],
    [2015, '313', True, 24750,4000,10000,0,0,0,0,0,233601],
    [2015, '314', True, 362000,186515,1388099,0,0,600000,0,0,461385],
    [2015, '315', True, 77127,94863,0,0,0,2000,0,0,0],
    [2015, '301', False, 0,0,140880,1065438,0,0,10000,0,0],
    [2015, '302', False, 0,0,1290000,1980000,530000,0,100000,0,0],
    [2015, '303', False, 0,0,1012639,0,35000,0,0,0,0],
    [2015, '304', False, 0,0,0,2078127,151800,0,3680269,0,0],
    [2015, '305', False, 0,0,0,1109562,0,0,12951229,0,0],
    [2015, '306', False, 0,0,300000,5084450,0,0,0,0,0],
    [2015, '307', False, 0,0,0,362405,0,0,705842,0,0],
    [2015, '021', False, 0,0,202000,2617793,0,0,212000,0,0],
    [2015, '309', False, 0,0,3500,509958,0,0,28000,0,0],
    [2015, '310', False, 0,0,0,49083,0,0,460449,0,0],
    [2015, '311', False, 0,0,26330314,7097756,0,0,200000,0,0],
    [2015, '312', False, 0,0,0,430000,0,0,885000,0,0],
    [2015, '313', False, 0,0,0,38750,0,0,233601,0,0],
    [2015, '314', False, 0,0,0,1936614,0,0,1061385,0,0],
    [2015, '315', False, 0,0,20000,153990,0,0,0,0,0],
    [2016, '001', True, 4873250,24191750,50000,0,0,0,0,0,485000],
    [2016, '002', True, 2621000,615916,11484,1600,0,7321394,8509190,0,819416],
    [2016, '003', True, 3109361,15007245,10236937,0,0,32587904,0,0,32170275],
    [2016, '004', True, 13575854,3143092,10000,0,0,926000,0,0,905430],
    [2016, '005', True, 2358041,3793500,2340410,0,0,868395,0,2300000,12969369],
    [2016, '006', True, 11100000,14500000,15200000,0,0,2955204,0,0,30783700],
    [2016, '007', True, 1690000,1644230,35000,0,0,0,0,0,1309091],
    [2016, '008', True, 1482962,314043,2338894,0,0,8835453,0,0,10674500],
    [2016, '010', True, 6003372,1733202,241136,1056029,0,730000,55595729,0,1173640],
    [2016, '011', True, 4242000,3200000,4247951,0,0,2929971,0,0,6428029],
    [2016, '017', True, 1656885,1002646,17625,0,0,0,0,0,200417],
    [2016, '018', True, 2973933,1546725,379855,0,0,100504,0,0,5495103],
    [2016, '019', True, 618000,173500,0,0,0,28400,0,0,0],
    [2016, '001', False, 0,0,1000000,28600000,0,0,0,0,0],
    [2016, '002', False, 0,0,350000,2900000,0,0,16650000,0,0],
    [2016, '003', False, 0,0,50212976,3596629,0,0,39302117,0,0],
    [2016, '004', False, 0,0,700000,16028946,0,0,1831430,0,0],
    [2016, '005', False, 0,0,1100000,2121896,3812000,2326450,1549933,0,13719436],
    [2016, '006', False, 0,0,6500000,33700000,600000,0,2955204,0,30783700],
    [2016, '007', False, 0,0,687000,2682230,0,0,1309091,0,0],
    [2016, '008', False, 0,0,0,4135899,0,0,19509953,0,0],
    [2016, '010', False, 0,0,0,9033739,0,0,57499369,0,0],
    [2016, '011', False, 0,0,18000000,3047951,0,0,0,0,0],
    [2016, '017', False, 0,0,820500,1856656,0,0,200417,0,0],
    [2016, '018', False, 0,0,312000,4588513,0,0,5595607,0,0],
    [2016, '019', False, 0,0,75100,716400,0,0,28400,0,0],
    [2016, '110', True, 3120000,800000,85000,0,0,65000,0,0,375000],
    [2016, '111', True, 571912,3061144,0,0,0,671074,0,0,0],
    [2016, '110', False, 0,0,0,4005000,0,0,440000,0,0],
    [2016, '111', False, 0,0,1409830,2215460,7766,0,671074,0,0],
    [2016, '201', True, 1954653,928074,265192,118278,0,0,2729412,0,562500],
    [2016, '202', True, 2207927,364500,0,0,0,32644,0,0,0],
    [2016, '203', True, 6686330,1962000,48100,42000,0,0,0,0,84402],
    [2016, '209', True, 64600,25000,27162,0,0,0,0,0,135334],
    [2016, '210', True, 0,51000,0,0,0,280000,0,0,0],
    [2016, '212', True, 3916180,5213327,5000,45000,0,157058,0,0,17500],
    [2016, '213', True, 414951,269211,0,0,0,0,0,0,0],
    [2016, '214', True, 1096357,942415,0,0,0,162082,0,0,0],
    [2016, '215', True, 16630722,3194494,0,3300507,0,0,0,0,0],
    [2016, '216', True, 0,0,0,65000,0,15000,15000,0,0],
    [2016, '222', True, 8086191,2851942,197000,55000,0,200000,0,0,1703485],
    [2016, '201', False, 0,0,194540,3071657,0,0,3291912,0,0],
    [2016, '202', False, 0,0,232000,2361071,12000,0,0,0,0],
    [2016, '203', False, 0,0,8738430,0,0,0,84402,0,0],
    [2016, '209', False, 0,0,49600,67162,0,0,135334,0,0],
    [2016, '210', False, 0,0,0,51000,0,0,280000,0,0],
    [2016, '212', False, 0,0,9238333,19800,100,0,95832,0,0],
    [2016, '213', False, 0,0,91739,586423,6000,0,0,0,0],
    [2016, '214', False, 0,0,471845,1560083,6844,0,162082,0,0],
    [2016, '215', False, 0,0,2225962,20630361,269400,0,0,0,0],
    [2016, '216', False, 0,0,0,55000,10000,0,30000,0,0],
    [2016, '222', False, 0,0,10317310,382823,540000,0,1853485,0,0],
    [2016, '301', True, 894750,324912,0,0,0,5000,0,0,0],
    [2016, '302', True, 2585600,1214400,0,0,0,100000,0,0,0],
    [2016, '303', True, 0,10000,0,0,0,1029191,0,0,0],
    [2016, '304', True, 424200,1302520,394985,0,0,600000,0,0,3098759],
    [2016, '305', True, 0,25000,792630,0,0,0,0,0,12298875],
    [2016, '306', True, 4191500,1214278,1672,0,0,27000,0,0,0],
    [2016, '307', True, 0,0,322596,0,0,0,0,0,451139],
    [2016, '021', True, 1139255,1063273,0,1098138,0,100722,112000,0,0],
    [2016, '309', True, 0,509516,0,0,0,86184,0,0,0],
    [2016, '310', True, 0,0,24019,0,0,0,0,0,460451],
    [2016, '311', True, 657554,31900970,0,0,0,1161634,0,0,0],
    [2016, '312', True, 0,0,389000,0,0,0,0,0,899000],
    [2016, '313', True, 0,30000,30321,0,0,0,0,0,233601],
    [2016, '314', True, 365620,488895,1250986,0,0,600000,0,0,462666],
    [2016, '315', True, 112427,88424,0,0,0,2000,0,0,0],
    [2016, '301', False, 0,0,140880,1078782,0,0,5000,0,0],
    [2016, '302', False, 0,0,1290000,1980000,530000,0,100000,0,0],
    [2016, '303', False, 0,0,974191,0,65000,0,0,0,0],
    [2016, '304', False, 0,0,0,1994985,126720,0,3698759,0,0],
    [2016, '305', False, 0,0,0,817630,0,0,12298875,0,0],
    [2016, '306', False, 0,0,350000,5084450,0,0,0,0,0],
    [2016, '307', False, 0,0,0,322596,0,0,451139,0,0],
    [2016, '021', False, 0,0,250000,3051388,0,0,212000,0,0],
    [2016, '309', False, 0,0,3950,505566,0,0,86184,0,0],
    [2016, '310', False, 0,0,0,24019,0,0,460451,0,0],
    [2016, '311', False, 0,0,26195639,7009519,0,0,515000,0,0],
    [2016, '312', False, 0,0,0,389000,0,0,899000,0,0],
    [2016, '313', False, 0,0,0,60321,0,0,233601,0,0],
    [2016, '314', False, 0,0,0,2105501,0,0,1062666,0,0],
    [2016, '315', False, 0,0,2000,200851,0,0,0,0,0],
    [2017, '001', True, 4873250,25916750,25000,0,0,0,0,0,485000],
    [2017, '002', True, 2552000,489035,4000,120000,0,7555001,8000000,0,819416],
    [2017, '003', True, 3154300,18774120,7993203,0,0,52554719,0,0,30027275],
    [2017, '004', True, 13806254,4485472,13702,0,0,863999,0,0,530431],
    [2017, '005', True, 2358041,3793500,2046944,0,0,2023761,0,3000000,14517307],
    [2017, '006', True, 10600000,13704482,12950000,0,0,13607760,0,0,35250456],
    [2017, '007', True, 1850000,1699730,12500,0,0,0,0,0,1309091],
    [2017, '008', True, 1482962,355356,1400546,0,0,15527431,0,0,9580750],
    [2017, '010', True, 6003372,1735769,200294,1089000,0,564679,57924654,0,1173637],
    [2017, '011', True, 4242000,4608000,3810625,0,0,12359275,5000000,0,6428029],
    [2017, '017', True, 1656885,1187292,5179,0,0,0,0,0,200417],
    [2017, '018', True, 3129237,1927680,288922,0,0,139000,0,0,5495103],
    [2017, '019', True, 620600,170900,0,0,0,68400,0,0,0],
    [2017, '001', False, 0,0,700000,30600000,0,0,0,0,0],
    [2017, '002', False, 0,0,350000,3165035,0,0,16024417,0,0],
    [2017, '003', False, 0,0,55565034,3341246,0,0,53597337,0,0],
    [2017, '004', False, 0,0,700000,17605428,0,0,1394430,0,0],
    [2017, '005', False, 0,0,1400000,1723343,3600000,3348101,3372820,0,14295289],
    [2017, '006', False, 0,0,6500000,30154482,600000,0,38858216,6625000,3375000],
    [2017, '007', False, 0,0,880000,2682230,0,0,1309091,0,0],
    [2017, '008', False, 0,0,0,3238864,0,0,25108181,0,0],
    [2017, '010', False, 0,0,0,9028435,0,0,59662970,0,0],
    [2017, '011', False, 0,0,19000000,2860625,0,0,0,14587304,0],
    [2017, '017', False, 0,0,862700,1986656,0,0,200417,0,0],
    [2017, '018', False, 0,0,468000,4877839,0,0,5634103,0,0],
    [2017, '019', False, 0,0,75100,716400,0,0,68400,0,0],
    [2017, '110', True, 3120000,909000,1000,0,0,100000,0,0,125000],
    [2017, '111', True, 562210,3060983,0,0,0,700000,0,0,0],
    [2017, '110', False, 0,0,0,4030000,0,0,225000,0,0],
    [2017, '111', False, 0,0,1377812,2237615,7766,0,700000,0,0],
    [2017, '201', True, 2764710,1059297,138177,119346,0,0,2729412,0,562500],
    [2017, '202', True, 2293927,414500,0,0,0,32644,0,0,0],
    [2017, '203', True, 7028665,2673460,1305,42000,0,0,0,0,84402],
    [2017, '209', True, 64600,34000,27162,0,0,6000,0,0,135334],
    [2017, '210', True, 0,51000,0,0,0,2576456,0,0,0],
    [2017, '212', True, 3916180,5237239,1500,45000,0,91071,0,0,17650],
    [2017, '213', True, 469402,279211,0,0,0,0,0,0,0],
    [2017, '214', True, 2338711,2238242,3000,0,0,0,0,0,0],
    [2017, '215', True, 21443365,3931060,0,2093755,0,0,0,0,0],
    [2017, '216', True, 0,0,0,65000,0,15000,20000,0,0],
    [2017, '222', True, 8099500,3756820,148600,53400,0,200000,0,0,1703485],
    [2017, '201', False, 0,0,174200,3871030,36300,0,3291912,0,0],
    [2017, '202', False, 0,0,232000,2497071,12000,0,0,0,0],
    [2017, '203', False, 0,0,0,9745430,0,0,84402,0,0],
    [2017, '209', False, 0,0,44600,87162,0,0,135334,0,0],
    [2017, '210', False, 0,0,0,51000,0,0,286128,0,2290328],
    [2017, '212', False, 0,0,9303990,4550,100,0,0,0,0],
    [2017, '213', False, 0,0,91739,650874,6000,0,0,0,0],
    [2017, '214', False, 0,0,2146891,2420562,12500,0,0,0,0],
    [2017, '215', False, 0,0,3142819,24199361,126000,0,0,0,0],
    [2017, '216', False, 0,0,0,60000,10000,0,30000,0,0],
    [2017, '222', False, 0,0,9941920,1618400,548000,0,1853485,0,0],
    [2017, '301', True, 894750,324912,0,0,0,5000,0,0,0],
    [2017, '302', True, 2579632,1374386,0,0,0,100000,0,0,0],
    [2017, '303', True, 0,10000,0,0,0,1332772,175000,0,0],
    [2017, '304', True, 424200,1271202,306588,0,0,461155,0,0,3118224],
    [2017, '305', True, 0,25000,576504,0,0,0,0,0,12107088],
    [2017, '306', True, 4191500,1794278,0,20000,0,28672,0,0,0],
    [2017, '307', True, 0,0,284126,0,0,0,0,0,451139],
    [2017, '021', True, 1139255,1652605,0,1841529,0,50000,100000,0,0],
    [2017, '309', True, 0,650529,0,0,0,133200,0,0,0],
    [2017, '310', True, 0,0,9094,0,0,0,0,0,411399],
    [2017, '311', True, 665794,37822772,0,0,0,1564073,0,0,0],
    [2017, '313', True, 0,1028,3360,0,0,0,0,0,233601],
    [2017, '314', True, 369277,490000,1147766,0,0,482000,0,0,91005],
    [2017, '301', False, 0,0,232674,986988,0,0,5000,0,0],
    [2017, '302', False, 0,0,1275500,2121596,556922,0,100000,0,0],
    [2017, '303', False, 0,0,1443556,0,74216,0,0,0,0],
    [2017, '304', False, 0,0,0,1772223,229767,0,3579379,0,0],
    [2017, '305', False, 0,0,0,601504,0,0,12107088,0,0],
    [2017, '306', False, 0,0,350000,5684450,0,0,0,0,0],
    [2017, '307', False, 0,0,0,284126,0,0,451139,0,0],
    [2017, '021', False, 0,0,262022,4371367,0,0,150000,0,0],
    [2017, '309', False, 0,0,3950,646579,0,0,133200,0,0],
    [2017, '310', False, 0,0,0,9094,0,0,411399,0,0],
    [2017, '311', False, 0,0,32278118,6759521,0,0,1015000,0,0],
    [2017, '313', False, 0,0,0,4388,0,0,233601,0,0],
    [2017, '314', False, 0,0,0,2007043,0,0,573005,0,0],
    [2018, '001', True, 5044347,26128000,10000,0,0,550000,0,0,490000],
    [2018, '002', True, 3000000,495301,4001,10909668,0,8305002,61898270,0,819416],
    [2018, '003', True, 3586243,24674251,6511856,0,0,37822410,0,0,26177481],
    [2018, '004', True, 16655056,3394091,6182,0,0,946998,200000,0,401542],
    [2018, '005', True, 2410766,3793500,1565530,0,0,11578028,0,1212000,16235117],
    [2018, '006', True, 11080000,13270313,10852119,0,0,14949268,0,0,35273462],
    [2018, '007', True, 2216064,1886709,12763,0,0,0,0,0,1309091],
    [2018, '008', True, 1852463,366035,1140340,0,0,26235493,0,0,5794507],
    [2018, '010', True, 6628873,1885301,157219,1188000,0,299391,66580205,0,1173638],
    [2018, '011', True, 4484420,5123580,3534487,0,0,16491898,0,0,6428029],
    [2018, '017', True, 1819932,1039710,0,0,0,250417,0,0,0],
    [2018, '018', True, 3212714,1474171,186950,0,0,336000,0,0,5495105],
    [2018, '019', True, 659950,152700,0,0,0,150000,0,0,0],
    [2018, '020', True, 560333,3136330,0,0,0,896598,0,0,0],
    [2018, '021', True, 1150648,1826712,0,1841529,0,50000,0,0,0],
    [2018, '022', True, 9321983,2877270,0,0,0,2511467,0,0,0],
    [2018, '001', False, 0,0,1000000,31100000,0,0,0,122347,0],
    [2018, '002', False, 0,0,350000,13949429,0,0,71022688,109541,0],
    [2018, '003', False, 0,0,56555362,3117490,0,0,38956546,142843,0],
    [2018, '004', False, 0,0,700000,19212675,0,0,1548540,142654,0],
    [2018, '005', False, 0,0,1500000,1493869,3700000,1627796,5098966,6027350,17346960],
    [2018, '006', False, 0,0,6500000,27920313,600000,1325000,29016117,182119,19881613],
    [2018, '007', False, 0,0,1087475,2938730,0,0,1309091,89331,0],
    [2018, '008', False, 0,0,0,3358838,0,0,25700000,6330000,0],
    [2018, '010', False, 0,0,0,9697944,0,0,68053234,161449,0],
    [2018, '011', False, 0,0,21000000,2732414,150000,0,0,12180000,0],
    [2018, '017', False, 0,0,858321,1886656,0,0,250417,114665,0],
    [2018, '018', False, 0,0,45500,4803577,0,0,5831105,24758,0],
    [2018, '019', False, 0,0,80627,707700,0,0,150000,24323,0],
    [2018, '020', False, 0,0,1378994,2309903,7766,0,896598,0,0],
    [2018, '021', False, 0,0,313022,4484367,0,0,71500,0,0],
    [2018, '022', False, 0,0,12199253,0,0,0,0,2511467,0],
    [2018, '110', True, 3435397,1007579,0,0,0,425000,0,0,0],
    [2018, '110', False, 0,0,0,4365046,0,0,425000,77930,0],
    [2018, '201', True, 2914403,1001179,98342,902140,0,0,10729412,0,562500],
    [2018, '202', True, 2880375,492310,0,0,0,20000,0,0,0],
    [2018, '203', True, 7551125,2676000,1305,42000,0,0,0,0,84402],
    [2018, '209', True, 65250,34000,3000,0,0,6000,0,0,135334],
    [2018, '212', True, 4119243,5394900,1500,11250,0,265921,0,0,17760],
    [2018, '214', True, 3239255,2146564,15000,72415,0,178957,0,0,0],
    [2018, '215', True, 18781595,3163129,0,1262594,0,0,0,0,0],
    [2018, '222', True, 8835736,4468089,106383,23000,0,325000,0,0,1676383],
    [2018, '223', True, 4246496,1686035,0,50000,0,40000,0,0,0],
    [2018, '201', False, 0,0,171150,4611196,36300,0,11291912,97418,0],
    [2018, '202', False, 0,0,338000,2953500,12000,0,0,89185,0],
    [2018, '203', False, 0,0,0,10270430,0,0,84402,0,0],
    [2018, '209', False, 0,0,45250,63000,0,0,135334,0,0],
    [2018, '212', False, 0,0,9568400,6800,100,0,76031,159243,0],
    [2018, '214', False, 0,0,2265057,2885080,11303,0,178957,311794,0],
    [2018, '215', False, 0,0,2187935,20127684,138000,0,0,753699,0],
    [2018, '222', False, 0,0,10888264,1933783,585000,0,2001383,26161,0],
    [2018, '223', False, 0,0,275000,5734450,0,0,0,13081,0],
    [2018, '301', True, 934990,329238,0,23000,0,5000,0,0,0],
    [2018, '302', True, 2538238,1494280,0,0,0,100000,0,0,0],
    [2018, '303', True, 0,10000,0,0,0,5918294,16545000,0,0],
    [2018, '304', True, 428442,1266959,628892,0,0,8461155,0,0,3138714],
    [2018, '305', True, 0,25000,462042,0,0,0,0,0,11782242],
    [2018, '307', True, 0,0,246266,0,0,0,0,0,451139],
    [2018, '309', True, 0,762863,0,0,0,133342,0,0,0],
    [2018, '310', True, 0,0,2084,0,0,0,0,0,194445],
    [2018, '311', True, 672451,37048607,0,0,0,4959133,0,0,0],
    [2018, '313', True, 0,4949,3735,0,0,0,0,0,233601],
    [2018, '314', True, 372969,497109,1040439,0,0,16643856,0,0,91674],
    [2018, '301', False, 0,0,246616,1040612,0,0,5000,0,0],
    [2018, '302', False, 0,0,1319000,2151596,561922,0,100000,0,0],
    [2018, '303', False, 0,0,1095291,0,8000,0,0,21370003,0],
    [2018, '304', False, 0,0,0,2094526,229767,0,11599869,0,0],
    [2018, '305', False, 0,0,0,487042,0,0,11782242,0,0],
    [2018, '307', False, 0,0,0,246266,0,0,451139,0,0],
    [2018, '309', False, 0,0,3950,758913,0,0,133342,0,0],
    [2018, '310', False, 0,0,0,2084,0,0,194445,0,0],
    [2018, '311', False, 0,0,29445954,8309237,0,0,4925000,0,0],
    [2018, '313', False, 0,0,0,8684,0,0,233601,0,0],
    [2018, '314', False, 0,0,0,1910517,0,0,2714774,14020756,0],
]

entity_descriptions = [
    ['001', 'Ens públic Radiotelevisió de les Illes Balears', 'Ente público Radiotelevisión de las Illes Balears'],
    ['002', 'Agència del Turisme de les Illes Balears', 'Agencia del Turismo de las Illes Balears'],
    ['003', "Agència Balear de l'Aigua i de la Qualitat Ambiental", 'Agencia Balear del Agua y de la Calidad Ambiental'],
    ['004', 'Institut Balear de la Natura', 'Instituto Balear de la Naturaleza'],
    ['005', "Institut Balear de l'Habitatge", 'Instituto Balear de la Vivienda'],
    ['006', 'Serveis Ferroviaris de Mallorca', 'Servicios Ferroviarios de Mallorca'],
    ['007', "Institut d'Innovació Empresarial de les Illes Balears", 'Instituto de Innovación Empresarial de las Illes Balears'],
    ['008', "Institut Balear d'Infraestructures i Serveis Educatius i Culturals", 'Instituto Balear de Infraestructuras y Servicios Educativos y Culturales'],
    ['010', 'Fons de Garantia Agrària i Pesquera de les Illes Balears', 'Fondo de Garantía Agraria y Pesquera de las Illes Balears'],
    ['011', 'Ports de les Illes Balears', 'Puertos de las Illes Balears'],
    ['017', 'Institut Balear de la Joventut', 'Instituto Balear de la Juventud'],
    ['018', 'Serveis de Millora Agrària i Pesquera', 'Servicios de Mejora Agraria y Pesquera'],
    ['019', "Serveis d'Informació Territorial de les Illes Balears", 'Servicios de Información Territorial de las Illes Balears'],
    ['020', 'Telecomunicacions i Innovació de les Illes Balears', 'Telecomunicaciones e Innovación de las Illes Balears'],
    ['021', "Institut d'Estudis Baleàrics", 'Instituto de Estudios Baleáricos'],
    ['022', 'Gestió Sanitària i Assistencial de les Illes Balears', 'Gestión Sanitaria y Asistencial de las Illes Balears'],
    ['104', "Serveis de Millora Agrària, SA", 'Servicios de Mejora Agraria, SA'],
    ['105', "Serveis d'Informació Territorial de les Illes Balears, SA", 'Servicios de Información Territorial de las Illes Balears, SA'],
    ['108', "Ràdio de les Illes Balears, SA", 'Radio de las Illes Balears, SA'],
    ['109', "Televisió de les Illes Balears, SA", 'Televisión de las Illes Balears, SA'],
    ['110', "Gestió d'Emergències de les Illes Balears, SA", 'Gestión de Emergencias de las Illes Balears, SA'],
    ['111', 'Multimèdia de les Illes Balears, SA', 'Multimedia de las Illes Balears, SA'],
    ['201', "Fundació per a l'Esport Balear", 'Fundación para el  Deporte Balear'],
    ['202', 'Fundació Estudis Superiors de Música i Arts Escèniques', 'Fundación Estudios Superiores de Música y Artes Escénicas'],
    ['203', "Fundació Institut Socioeducatiu s'Estel", "Fundación Instituto Socioeducativo s'Estel"],
    ['209', 'Fundació Robert Graves', 'Fundación Robert Graves'],
    ['210', "Fundació Teatre Principal d'Inca", 'Fundación Teatro Principal de Inca'],
    ['212', 'Fundació Banc de Sang i Teixits de les Illes Balears', 'Fundación Banco de Sangre y Tejidos de las Illes Balears'],
    ['213', "Fundació Escola Superior d'Art Dramàtic de les Illes Balears", 'Fundación para la Escuela Superior de Arte Dramático de las Illes Balears'],
    ['214', "Fundació d'Investigació Sanitària de les Illes Balears Ramon Llull", 'Fundación de Investigación Sanitaria de las Illes Balears Ramon Llull'],
    ['215', "Fundació d'Atenció i Suport a la Dependència", 'Fundación Atención y Apoyo a la Dependencia'],
    ['216', 'Fundació Santuari de Lluc', 'Fundación Santuario de Lluc'],
    ['222', "Fundació Balear d'Innovació i Tecnologia", 'Fundación Balear de Innovación y Tecnología'],
    ['223', "Fundació Orquestra Simfònica Illes Balears", 'Fundación Orquesta Sinfónica Illes Balears'],
    ['301', 'Centre Balears Europa', 'Centro Baleares Europa'],
    ['302', 'Escola d’Hoteleria', 'Escuela de Hostelería'],
    ['303', 'Consorci Desestacionalització de l’Oferta a l’Illa de Mallorca', 'Consorcio Desestacionalitzación de la Oferta en la isla de Mallorca'],
    ['304', 'Velòdrom Palma Arena', 'Consorcio Velódromo Palma Arena'],
    ['305', 'Consorci d’Infraestructures de les Illes Balears', 'Consorcio de Infraestructuras de las Illes Balears'],
    ['306', 'Consorci Orquestra Simfònica Illes Balears “Ciutat de Palma”', 'Consorcio Orquesta Sinfònica de las Illes Balears “Ciutat de Palma”'],
    ['307', 'Consorci Foment d’Infraestructures Universitàries (COFIU)', 'Consorcio para el Fomento de Infraestructuras Universitarias (COFIU)'],
    ['309', 'Consorci Recuperació de la Fauna de les Illes Balears (COFIB)', 'Consorcio para la Recuperación de la Fauna de las Illes Balears (COFIB)'],
    ['310', "Consorci d'Aigües de les Illes Balears", 'Consorcio de Aguas de las Illes Balears'],
    ['311', 'Consorci de Transports de Mallorca', 'Consorcio de Transportes de Mallorca'],
    ['312', 'Consorci Formentera Desenvolupament', 'Consorcio Desarrollo Formentera'],
    ['313', 'Consorci Infraestructures ELM Palmanyola', 'Consorcio para el Desarrollo de Actuaciones en Palmanyola'],
    ['314', 'Consorci de Recursos Sociosanitaris i Assistencials IB', 'Consorcio de Recursos Sociosanitarios y Asistenciales IB'],
    ['315', 'Agència de Qualitat Universitària', 'Agencia de Calidad Universitaria'],
]

area_descriptions = [
    ['0', 'Entitats p&uacute;bliques empresarials', 'Entidades p&uacute;blicas empresariales'],
    ['1', 'Societats mercantils p&uacute;bliques', 'Sociedades mercantiles p&uacute;blicas'],
    ['2', 'Fundacions', 'Fundaciones'],
    ['3', 'Consorcis', 'Consorcios'],
]

def _get_area(item):
    return item.name[0]

def institutions(request, render_callback=None):
    # Get request context
    c = get_context(request, css_class='body-entities', title='')

    # Retrieve the entity to display
    main_entity = get_main_entity(c)
    set_title(c, main_entity.name)

    # Prepare the budget breakdowns
    c['breakdowns'] = {
        'economic': BudgetBreakdown(['name']),
        'economic_by_area': BudgetBreakdown([_get_area, 'name', 'chapter'])
    }
    for item in data:
        for chapter in range(1, 10):
            amount = item[2+chapter]*100
            if amount > 0:
                datapoint = DataPoint(year=item[0], name=item[1], expense=item[2], chapter='C'+str(chapter), amount=amount)
                c['breakdowns']['economic'].add_item(datapoint.year, datapoint)
                c['breakdowns']['economic_by_area'].add_item(datapoint.year, datapoint)

    # Additional data needed by the view
    populate_level(c, main_entity.level)
    populate_entity_stats(c, main_entity)
    populate_years(c, c['breakdowns']['economic'])
    populate_budget_statuses(c, main_entity.id)
    c['entity'] = main_entity

    # Add our custom descriptions
    descriptions_position = 1 if c['LANGUAGE_CODE']=='ca' else 2
    c['descriptions'] = { 'income': {}, 'expense': {} }
    for item in entity_descriptions:
        description = item[descriptions_position]
        c['descriptions']['income'][item[0]] = description
        c['descriptions']['expense'][item[0]] = description

    c['income_areas'] = {}
    c['expense_areas'] = {}
    for item in area_descriptions:
        description = item[descriptions_position]
        c['income_areas'][item[0]] = description
        c['expense_areas'][item[0]] = description
        c['descriptions']['income'][item[0]] = description
        c['descriptions']['expense'][item[0]] = description

    # Add standard chapter descriptions
    descriptions = Budget.objects.get_all_descriptions(main_entity)
    for chapter in range(1, 10):
        c['descriptions']['income']['C'+str(chapter)] = str(chapter) + ' ' + descriptions['income'][str(chapter)]
        c['descriptions']['expense']['C'+str(chapter)] = str(chapter) + ' ' + descriptions['expense'][str(chapter)]

    # if parameter widget defined use policies/widget template instead of policies/show
    template = 'institutions/index.html'

    return render(c, render_callback, template)
